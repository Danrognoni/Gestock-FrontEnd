<section class="existencia-container">

  <div class="header-section">
    <h1>Existencias</h1>
  </div>

  <div class="filtros-container">
    <button (click)="getExistencias()" class="btn-filtro btn-todos">
      Ver Todo
    </button>
    <button (click)="filtrarPorVencer()" class="btn-filtro btn-vencer">
       Por Vencer
    </button>
    <button (click)="filtrarBajoStock()" class="btn-filtro btn-stock">
       Bajo Stock
    </button>
  </div>

  <div class="existencias-grid">
    @for (existencia of existencias; track existencia.id) {
      <article class="existencia-card">

        <header class="card-header">
          @for(producto of productos(); track producto.id){
            @if(producto.id == existencia.productoId){
              <h3>{{ producto.nombre }}</h3>
            }
          }
        </header>

        <div class="card-body">
          <div class="data-item">
            <span class="data-label">Cantidad:</span>
            <span class="data-value" [class.text-danger]="+existencia.cantidad < 10">
              {{ existencia.cantidad }}
            </span>
          </div>

          <div class="data-item">
            <span class="data-label">Entrada:</span>
            <span class="data-value">{{ existencia.fechaEntrada }}</span>
          </div>

          <div class="data-item">
            <span class="data-label">Vencimiento:</span>
            <span class="data-value">{{ existencia.fechaVencimiento }}</span>
          </div>
        </div>

        <div class="card-actions">
          <button class="btn-eliminar" (click)="deleteExistencia(existencia.id)">
            Eliminar
          </button>
          <button class="btn-editar" [routerLink]="['/existencia/editExistencia', existencia.id]">
            Editar
          </button>
        </div>

      </article>
    } @empty {
      <div class="empty-state">
        <p>No se encontraron existencias con los filtros actuales.</p>
        <button (click)="getExistencias()" class="btn-link">Mostrar todas</button>
      </div>
    }
  </div>
</section>
