<section class="container">
  <h1>{{ isEditMode ? 'Editar Existencia' : 'Agregar nueva Existencia' }}</h1>
  <div class="form-container">
    <form [formGroup]="existenciaForm" (ngSubmit)="onSubmit()">
      <div class="formulario">
        <label for="cantidad">Cantidad</label>
        <input type="number" id="id-cantidad" formControlName="cantidad">
        @if(cantidad?.invalid && (cantidad?.touched)){
        <p class="msg-error">La cantidad es obligatoria</p>
        }
      </div>

      <div class="formulario">
        <label for="fechaEntrada">Fecha de entrada</label>
        <input type="date" id="id-fechaEntrada" formControlName="fechaEntrada">
        @if (fechaEntrada?.invalid && (fechaEntrada?.touched)) {
        @if (fechaEntrada?.hasError('required')) {
        <p class="error-msg">Fecha de entrada requerida</p>
        }
        @if (fechaEntrada?.hasError('max')) {
        <p class="error-msg">La fecha de entrada no puede ser mayor a ({{ anio }})</p>
        }
        }
      </div>



  <div class="formulario">
        <label for="fechaVencimiento">Fecha de vencimiento</label>
        <input type="date" id="id-fechaVencimiento" formControlName="fechaVencimiento">
        @if (fechaVencimiento?.invalid && (fechaVencimiento?.touched)) {
        @if (fechaVencimiento?.hasError('required')) {
        <p class="error-msg">Fecha de vencimiento requerida</p>
        }
        @if (fechaVencimiento?.hasError('min')) {
        <p class="error-msg">La fecha de vencimiento no puede ser menor a la fecha actual</p>
        }
        }
      </div>

  <div class="formulario">
    <label for="productoId">Producto</label>
    <select id="productoId" formControlName="productoId">
      <option [ngValue]="null" disabled>Seleccionar Productos</option>
      @for(producto of productos(); track producto.id){
      <option [value]="producto.id">{{producto.nombre}}</option>
      }@empty {
      <p>Cargando Productos..</p>
      }
    </select>
  </div>

  <div class="form-actions">
    <button type="submit" class="btn-primary" [disabled]="existenciaForm.invalid">
      {{ isEditMode ? 'Actualizar Existencia' : 'Guardar Existencia' }}
    </button>
  </div>
  </form>
  </div>
</section>
